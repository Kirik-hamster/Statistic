<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <link rel="stylesheet" type="text/css" href="../styles/style.css">
        <title>Statistic</title>
        
    </head>
    <body>
        <canvas id="myChart"></canvas>
        <table class="StatisticTable">
            <thead>
                <tr>
                    <th>C_id</th>
                    <th>C_size</th>
                    <th>C_elapsed_time</th>
                    <th>C_date</th>
                </tr>
            </thead>
        </table>
    </body>
    <script src=" https://cdn.jsdelivr.net/npm/chart.js@4.4.2/dist/chart.umd.min.js "></script>

    <script  src="../scripts/script.js"></script>

    <script>
document.addEventListener('DOMContentLoaded', async () => {
    let data = await fetchJson();

    let labels = data.map((i) => {
        return i.C_size_string;
    });

    let size = data.map((i) => {
        return 'item' + i.C_size;
    });

    let elapsedTime = data.map((i) => {
        return i.C_elapsed_time;
    });
    console.log(elapsedTime)

    let config = {
        type: 'line',
        data: {
            labels: labels,
            datasets: [{
                    lable: 'Elapsed time',
                    data: elapsedTime,
                    backgroundColor: 'rgba(75, 192, 192, 0.2)', 
                    borderColor: 'rgba(75, 192, 192, 1)',
                    borderWidth: 1
            }]
        },
        options: {
            scales: {
                y: {
                    type: 'linear',
                    position: 'left',
                    ticks: {
                        callback: function(value, index, values) {
                            let unit = 'ns'; // Начальная единица измерения
                            let convertedValue = value;

                            // Определяем единицу измерения в зависимости от максимального значения
                            if (value >= 1e9) {
                                unit = 's';
                                convertedValue = value / 1e9;
                            } else if (value >= 1e6) {
                                unit = 'ms';
                                convertedValue = value / 1e6;
                            } else if (value >= 1e3) {
                                unit = 'µs';
                                convertedValue = value / 1e3;
                            }

                            // Форматируем значение с учетом единицы измерения
                            return convertedValue.toFixed(1) + ' ' + unit;
                        }
                    }
                }
            }
        }
    };

    let ctx = document.getElementById('myChart').getContext('2d');

    var myChart = new Chart(ctx, config);
    
});

    </script>
</html>